---
parameters:
  env(ACLI_DATA_DIR): "%env(HOME)%"
  app.data_dir: "%env(HOME)%/.acquia"
  app.acli_config_filename: 'acquia-cli.json'
  app.cloud_config_filename: 'cloud_api.conf'
  app.acli_config_filepath: "%app.data_dir%/%app.acli_config_filename%"
  app.cloud_config_filepath: "%app.data_dir%/%app.cloud_config_filename%"

services:

  _defaults:
    autoconfigure: true
    autowire: true
    bind:
      $cloudConfigFilepath: '%app.cloud_config_filepath%'
      $acliConfigFilename: '%app.acli_config_filename%'
      $repoRoot: "%kernel.project_dir%"
      Webmozart\KeyValueStore\JsonFileStore $datastoreCloud: '@datastore.cloud'
      Webmozart\KeyValueStore\JsonFileStore $datastoreAcli: '@datastore.acli'
    public: true

  # Todo: something like the following instead of enumerating classes
  # Acquia\Cli\:
    # exclude: ../src/Kernel.php
    # public: false
    # resource: ../src

  Acquia\Cli\Helpers\ClientService: ~

  Acquia\Cli\Helpers\LocalMachineHelper: ~

  Acquia\Cli\Helpers\TelemetryHelper: ~

  Acquia\Cli\Command\AuthCommand:
    parent: Acquia\Cli\Command\CommandBase

  Acquia\Cli\Command\LinkCommand:
    parent: Acquia\Cli\Command\CommandBase

  # Todo: something like the following instead of enumerating commands.
  # Acquia\Cli\Command\:
  #   resource: ../src/Command
  #   parent: Acquia\Cli\Command\CommandBase
  #   exclude: ../src/Command/CommandBase.php

  Acquia\Cli\Command\CommandBase:
    abstract: true

  AcquiaCloudApi\Connector\Client: ~

  AcquiaCloudApi\Connector\ConnectorInterface: ~

  Psr\Log\LoggerInterface:
    alias: Symfony\Component\Console\Logger\ConsoleLogger

  Symfony\Component\Console\Application: ~

  Symfony\Component\Console\Input\ArgvInput: ~

  Symfony\Component\Console\Input\InputInterface:
    alias: Symfony\Component\Console\Input\ArgvInput

  Symfony\Component\Console\Logger\ConsoleLogger: ~

  Symfony\Component\Console\Output\ConsoleOutput: ~

  Symfony\Component\Console\Output\OutputInterface:
    alias: Symfony\Component\Console\Output\ConsoleOutput

  Zumba\Amplitude\Amplitude: ~

  datastore.cloud:
    class: Webmozart\KeyValueStore\JsonFileStore
    arguments:
      $path: '%app.cloud_config_filepath%'
      $flags: !php/const Webmozart\KeyValueStore\JsonFileStore::NO_SERIALIZE_STRINGS

  datastore.acli:
    class: Webmozart\KeyValueStore\JsonFileStore
    arguments:
      $path: '%app.acli_config_filepath%'
